(function(t){function e(e,i){var n=e.options,l=(e.$select,e.$ul),a=n.templates,r=l.find(".multiselect-filter")||!1;if(0===r.length){r=t(a.filter);var u=t(a.filterClearBtn);r.find(".input-group").append(u),l.prepend(r)}var o=r.find(".multiselect-search");return setTimeout(function(){o.focus().val(i)},100),r}function i(i){var n="",l=i.options,a=i.$select,r=i.$ul,u=e(i,n),o=u.find(".multiselect-search"),c=u.find(".multiselect-clear-filter"),s=a.data("multiselectAjax");c.click(function(){o.val(""),a.empty(),r.find("li").not(u).remove()});var f=null;u.val(n).on("click",function(t){t.stopPropagation()}).on("input keydown",t.proxy(function(e){if(9===e.which)return!0;13===e.which&&e.preventDefault();var i=e.target.value;return 0===i.toString().trim().length||(a.empty(),r.find("li").not(u).remove(),clearTimeout(f),void(f=setTimeout(function(){n=e.target.value,t.ajax({url:s.url,method:s.method,dataType:s.dataType,data:{query:n},success:function(e){if(!e)return!0;var i=l.multiple?"checkbox":"radio";t(e).each(function(){console.log(this);var e=this.value,n=this.id;a.append(t("<option />").val(n).text(e));var u=t(l.templates.li),o=t("label",u);o.addClass(i),o.attr("title",e),o.text(" "+e);var c=t("<input/>").attr("type",i);o.prepend(c),c.val(n),r.append(u)}),r.find("li:not(.multiselect-filter)").first().addClass("active").find("a").focus()}})},500)))}))}var n={onDropdownShow:function(){var t=this.$ul;setTimeout(function(){t.find(".multiselect-filter input").focus()},100)},onInitialized:function(){i(this)}},l=function(e,i,l){var a=t(e);if(void 0==i)return console.error("ajaxOption url not defined"),!1;var r=a.data("multiselect");a.data("multiselectAjax");return"string"==typeof i&&(i={url:i}),i=t.extend({url:null,dataType:"json",method:"POST"},i),a.data("multiselectAjax",i),l=t.extend({},l,n),void 0==r?a.multiselect(l):this};t.fn.multiselectAjax=function(e,i){return this.each(function(){try{t.fn.multiselect()}catch(t){return alert(t),!1}return new l(this,e,i)})}})(jQuery);